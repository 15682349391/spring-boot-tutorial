<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN" monitorInterval="30">
  <Properties>
    <property name="FILE_NAME" value="spring-boot-basic-aop"/>
    <property name="FILE_DIR" value="logs"/>
    <property name="LOG_PATTERN" value="%d{yyyy-MM-dd HH:mm:ss.SSS} [%t] [%-5level] %c{36}#%M - %msg%n"/>
  </Properties>
  <Appenders>
    <Console name="Console" target="SYSTEM_OUT" follow="true">
      <PatternLayout pattern="${LOG_PATTERN}"/>
    </Console>
    <RollingFile name="All" fileName="${FILE_DIR}/${FILE_NAME}-trace.log"
                 filePattern="${FILE_DIR}/${date:yyyy-MM}/${FILE_NAME}-trace-%d{yyyy-MM-dd}-%i.log.gz">
      <PatternLayout>
        <Pattern>${LOG_PATTERN}</Pattern>
      </PatternLayout>
      <Filters>
        <ThresholdFilter level="warn" onMatch="ACCEPT" onMismatch="DENY"/>
      </Filters>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
        <SizeBasedTriggeringPolicy size="250 MB"/>
      </Policies>
      <DefaultRolloverStrategy>
        <Delete basePath="${FILE_DIR}" maxDepth="2">
          <IfFileName glob="*/${FILE_NAME}-*.log.gz"/>
          <IfLastModified age="30d"/>
        </Delete>
      </DefaultRolloverStrategy>
    </RollingFile>
  </Appenders>
  <Loggers>
    <Logger name="org.hibernate.validator.internal.util.Version" level="warn"/>
    <Logger name="org.apache.coyote.http11.Http11NioProtocol" level="warn"/>
    <Logger name="org.apache.tomcat.util.net.NioSelectorPool" level="warn"/>
    <Root level="warn">
      <AppenderRef ref="Console"/>
      <AppenderRef ref="All"/>
    </Root>
  </Loggers>
</Configuration>
